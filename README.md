
<!-- README.md is generated from README.Rmd. Please edit that file -->

# phutil

<!-- badges: start -->

[![R-CMD-check](https://github.com/tdaverse/phutil/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/tdaverse/phutil/actions/workflows/R-CMD-check.yaml)
[![Codecov test
coverage](https://codecov.io/gh/tdaverse/phutil/graph/badge.svg)](https://app.codecov.io/gh/tdaverse/phutil)
<!-- badges: end -->

The goal of the **phutil** package is to provide utility functions for
persistence data analysis. In particular, the package defines a data
structure for hosting persistence data. The package is part of the
[*tdaverse*](https://github.com/tdaverse) suite of packages, which aims
to provide a consistent interface for topological data analysis in R
that nicely integrates with the
[*tidymodels*](https://www.tidymodels.org) ecosystem.

## Installation

You can install the development version of **phutil** from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("tdaverse/phutil")
```

## Example

The package currently provides a new data structure for hosting
persistence data. The data set `noisy_circle_points` is a simulated data
set consisting of 100 points sampled from a circle with additive
Gaussian noise using a standard deviation of $0.05$:

``` r
library(phutil)
noisy_circle_points
#>                  x            y
#>   [1,]  0.66517207  0.636317170
#>   [2,] -0.74810664 -0.690126161
#>   [3,] -0.82885445 -0.551968932
#>   [4,] -0.76501805 -0.743649923
#>   [5,]  0.63372957 -0.760746359
#>   [6,] -0.60776626 -0.703649232
#>   [7,]  1.08061153  0.047897151
#>   [8,]  0.07075121  0.941326588
#>   [9,] -0.42287299 -0.907677519
#>  [10,] -1.05388417 -0.108929305
#>  [11,] -0.31422302 -0.980213228
#>  [12,] -0.83288823 -0.291871238
#>  [13,] -0.20596225  0.958203150
#>  [14,]  0.85301326 -0.471890825
#>  [15,] -0.26313701  0.985214908
#>  [16,]  0.61025748 -0.822078748
#>  [17,] -0.28256813  1.058121563
#>  [18,] -0.03710007  0.990985529
#>  [19,]  0.45366872  0.905957749
#>  [20,]  0.12826954  1.067320788
#>  [21,] -0.40608080  0.998900418
#>  [22,] -0.34784009  0.947853308
#>  [23,]  0.52255196  0.824468089
#>  [24,]  1.00100387  0.157553274
#>  [25,]  0.29829856  1.051409080
#>  [26,]  0.36394874 -0.970264587
#>  [27,] -1.05652828 -0.216949944
#>  [28,]  0.82346763 -0.358700653
#>  [29,]  0.50205529 -0.860452983
#>  [30,]  0.94307925  0.281972430
#>  [31,] -0.97107390  0.135787940
#>  [32,] -0.10377564  0.990461371
#>  [33,] -0.40541445  0.990378027
#>  [34,] -1.00763566 -0.025200847
#>  [35,]  0.46204870  0.953354306
#>  [36,]  0.09560545 -0.898967924
#>  [37,]  0.32904958  1.011905880
#>  [38,] -0.07546206  0.973031523
#>  [39,]  0.98920431 -0.014091379
#>  [40,]  0.29288042 -0.945692386
#>  [41,] -0.94703378 -0.355771714
#>  [42,] -0.59314260 -0.938326918
#>  [43,] -0.29345946  0.886013543
#>  [44,] -0.67102090 -0.668443847
#>  [45,] -0.50526693  0.985403059
#>  [46,] -0.98214373  0.012484567
#>  [47,] -0.49895601 -0.865893337
#>  [48,] -0.95164660  0.045867954
#>  [49,]  0.08678289  1.007405253
#>  [50,]  0.20303988 -1.099197815
#>  [51,]  0.91518688  0.471407897
#>  [52,] -0.39002891  0.965338010
#>  [53,] -0.20089179 -0.969655275
#>  [54,] -1.02471600  0.006477751
#>  [55,]  0.53113756  0.835532416
#>  [56,] -0.99134514  0.013310799
#>  [57,] -1.04409342  0.130058716
#>  [58,]  0.01595026 -0.944353424
#>  [59,]  0.47369822  0.891638687
#>  [60,]  0.57697845 -0.870635163
#>  [61,]  0.65073161 -0.729898222
#>  [62,]  0.93316168  0.239963918
#>  [63,] -0.46518176  0.986897940
#>  [64,]  1.03873412  0.005931938
#>  [65,]  0.07001689  0.976836067
#>  [66,] -0.22840383 -0.941770878
#>  [67,] -0.41918249  0.926529751
#>  [68,] -0.99010686 -0.083987681
#>  [69,]  0.98146689  0.303603871
#>  [70,] -0.92013849 -0.363189154
#>  [71,]  0.71300110  0.736055622
#>  [72,]  0.74265481 -0.590581152
#>  [73,]  1.09868774  0.205450606
#>  [74,]  0.24413224 -0.919749098
#>  [75,]  0.93566850  0.550007134
#>  [76,] -0.98873675 -0.153270768
#>  [77,] -0.77862656  0.810718005
#>  [78,]  0.82902215  0.459948501
#>  [79,] -0.46124445  0.868879632
#>  [80,] -0.47870129 -0.862388631
#>  [81,]  0.94565136 -0.462352320
#>  [82,] -0.97182739  0.161846303
#>  [83,]  0.56607948  0.734208163
#>  [84,] -0.92812794 -0.268739836
#>  [85,]  0.24927949  0.959313206
#>  [86,]  0.78544979 -0.648854546
#>  [87,] -0.78431197  0.478184912
#>  [88,] -0.47061838  0.915004738
#>  [89,]  0.58167760  0.845900303
#>  [90,]  0.76355617 -0.577289031
#>  [91,]  0.48478231  0.868123592
#>  [92,]  0.88033961 -0.564954910
#>  [93,]  0.69747902  0.691379668
#>  [94,]  0.67169731  0.771432393
#>  [95,]  0.81473469  0.650277850
#>  [96,] -0.97738898 -0.060134994
#>  [97,] -0.22706341  1.018533009
#>  [98,]  0.99973803  0.187303339
#>  [99,] -0.34075033  0.943807907
#> [100,] -0.03211583 -0.985372254
```

The data set `noisy_circle_ripserr` is a persistence diagram computed
using the [**ripserr**](https://tdaverse.github.io/ripserr/) package
with the
[`ripserr::vietoris_rips()`](https://tdaverse.github.io/ripserr/reference/vietoris_rips.html)
and stored as an object of class ‘PHom’, which is a light wrapper around
a data frame with 3 variables:

``` r
noisy_circle_ripserr
#>     dimension      birth       death
#> 1           0 0.00000000 0.008162723
#> 2           0 0.00000000 0.008548402
#> 3           0 0.00000000 0.009238432
#> 4           0 0.00000000 0.014004707
#> 5           0 0.00000000 0.020555701
#> 6           0 0.00000000 0.024621462
#> 7           0 0.00000000 0.024769890
#> 8           0 0.00000000 0.025996476
#> 9           0 0.00000000 0.026069254
#> 10          0 0.00000000 0.027031372
#> 11          0 0.00000000 0.027899370
#> 12          0 0.00000000 0.029389071
#> 13          0 0.00000000 0.029776983
#> 14          0 0.00000000 0.033248437
#> 15          0 0.00000000 0.034063248
#> 16          0 0.00000000 0.034865081
#> 17          0 0.00000000 0.035223243
#> 18          0 0.00000000 0.035517071
#> 19          0 0.00000000 0.035989881
#> 20          0 0.00000000 0.039172078
#> 21          0 0.00000000 0.040113039
#> 22          0 0.00000000 0.042355499
#> 23          0 0.00000000 0.043163334
#> 24          0 0.00000000 0.044062798
#> 25          0 0.00000000 0.045216427
#> 26          0 0.00000000 0.045668485
#> 27          0 0.00000000 0.046208831
#> 28          0 0.00000000 0.047067993
#> 29          0 0.00000000 0.047295623
#> 30          0 0.00000000 0.048131669
#> 31          0 0.00000000 0.048538771
#> 32          0 0.00000000 0.049106015
#> 33          0 0.00000000 0.050061244
#> 34          0 0.00000000 0.051592529
#> 35          0 0.00000000 0.052711260
#> 36          0 0.00000000 0.053424110
#> 37          0 0.00000000 0.054383073
#> 38          0 0.00000000 0.055221726
#> 39          0 0.00000000 0.056131890
#> 40          0 0.00000000 0.056665629
#> 41          0 0.00000000 0.058866113
#> 42          0 0.00000000 0.059285719
#> 43          0 0.00000000 0.059868540
#> 44          0 0.00000000 0.063189342
#> 45          0 0.00000000 0.063234392
#> 46          0 0.00000000 0.063840563
#> 47          0 0.00000000 0.065670399
#> 48          0 0.00000000 0.068176443
#> 49          0 0.00000000 0.068480870
#> 50          0 0.00000000 0.069296633
#> 51          0 0.00000000 0.071887979
#> 52          0 0.00000000 0.072299367
#> 53          0 0.00000000 0.072391768
#> 54          0 0.00000000 0.072876701
#> 55          0 0.00000000 0.073243933
#> 56          0 0.00000000 0.074676735
#> 57          0 0.00000000 0.075196405
#> 58          0 0.00000000 0.075611873
#> 59          0 0.00000000 0.080077051
#> 60          0 0.00000000 0.081223989
#> 61          0 0.00000000 0.084885493
#> 62          0 0.00000000 0.086923406
#> 63          0 0.00000000 0.087967986
#> 64          0 0.00000000 0.089061655
#> 65          0 0.00000000 0.091677657
#> 66          0 0.00000000 0.091994695
#> 67          0 0.00000000 0.093009295
#> 68          0 0.00000000 0.093127873
#> 69          0 0.00000000 0.094035885
#> 70          0 0.00000000 0.095547148
#> 71          0 0.00000000 0.096993058
#> 72          0 0.00000000 0.098008489
#> 73          0 0.00000000 0.100207281
#> 74          0 0.00000000 0.100600042
#> 75          0 0.00000000 0.107157343
#> 76          0 0.00000000 0.108047450
#> 77          0 0.00000000 0.111985578
#> 78          0 0.00000000 0.116982730
#> 79          0 0.00000000 0.117432967
#> 80          0 0.00000000 0.118818087
#> 81          0 0.00000000 0.124250763
#> 82          0 0.00000000 0.130409100
#> 83          0 0.00000000 0.130637844
#> 84          0 0.00000000 0.135505886
#> 85          0 0.00000000 0.145317069
#> 86          0 0.00000000 0.149973549
#> 87          0 0.00000000 0.157096157
#> 88          0 0.00000000 0.157216617
#> 89          0 0.00000000 0.160023839
#> 90          0 0.00000000 0.162200631
#> 91          0 0.00000000 0.169506194
#> 92          0 0.00000000 0.176442651
#> 93          0 0.00000000 0.177862977
#> 94          0 0.00000000 0.180419597
#> 95          0 0.00000000 0.195353064
#> 96          0 0.00000000 0.209691635
#> 97          0 0.00000000 0.322667292
#> 98          0 0.00000000 0.332581692
#> 99          0 0.00000000 0.367739240
#> 100         1 0.38239273 1.632187167
#> 101         1 0.07209847 0.075896319
```

The data set `noisy_circle_tda_rips` is a persistence diagram computed
using the **TDA** package with the
[`TDA::ripsDiag()`](https://www.rdocumentation.org/packages/TDA/versions/1.9.1/topics/ripsDiag)
and stored as an object of class ‘diagram’, which is a matrix with 3
columns:

``` r
noisy_circle_tda_rips
#>        dimension      Birth       Death
#>   [1,]         0 0.00000000 1.632200000
#>   [2,]         0 0.00000000 0.367739240
#>   [3,]         0 0.00000000 0.332581692
#>   [4,]         0 0.00000000 0.322667292
#>   [5,]         0 0.00000000 0.209691635
#>   [6,]         0 0.00000000 0.195353064
#>   [7,]         0 0.00000000 0.180419597
#>   [8,]         0 0.00000000 0.177862977
#>   [9,]         0 0.00000000 0.176442651
#>  [10,]         0 0.00000000 0.169506194
#>  [11,]         0 0.00000000 0.162200631
#>  [12,]         0 0.00000000 0.160023839
#>  [13,]         0 0.00000000 0.157216617
#>  [14,]         0 0.00000000 0.157096157
#>  [15,]         0 0.00000000 0.149973549
#>  [16,]         0 0.00000000 0.145317069
#>  [17,]         0 0.00000000 0.135505886
#>  [18,]         0 0.00000000 0.130637844
#>  [19,]         0 0.00000000 0.130409100
#>  [20,]         0 0.00000000 0.124250763
#>  [21,]         0 0.00000000 0.118818087
#>  [22,]         0 0.00000000 0.117432967
#>  [23,]         0 0.00000000 0.116982730
#>  [24,]         0 0.00000000 0.111985578
#>  [25,]         0 0.00000000 0.108047450
#>  [26,]         0 0.00000000 0.107157343
#>  [27,]         0 0.00000000 0.100600042
#>  [28,]         0 0.00000000 0.100207281
#>  [29,]         0 0.00000000 0.098008489
#>  [30,]         0 0.00000000 0.096993058
#>  [31,]         0 0.00000000 0.095547148
#>  [32,]         0 0.00000000 0.094035885
#>  [33,]         0 0.00000000 0.093127873
#>  [34,]         0 0.00000000 0.093009295
#>  [35,]         0 0.00000000 0.091994695
#>  [36,]         0 0.00000000 0.091677657
#>  [37,]         0 0.00000000 0.089061655
#>  [38,]         0 0.00000000 0.087967986
#>  [39,]         0 0.00000000 0.086923406
#>  [40,]         0 0.00000000 0.084885493
#>  [41,]         0 0.00000000 0.081223989
#>  [42,]         0 0.00000000 0.080077051
#>  [43,]         0 0.00000000 0.075611873
#>  [44,]         0 0.00000000 0.075196405
#>  [45,]         0 0.00000000 0.074676735
#>  [46,]         0 0.00000000 0.073243933
#>  [47,]         0 0.00000000 0.072876701
#>  [48,]         0 0.00000000 0.072391768
#>  [49,]         0 0.00000000 0.072299367
#>  [50,]         0 0.00000000 0.071887979
#>  [51,]         0 0.00000000 0.069296633
#>  [52,]         0 0.00000000 0.068480870
#>  [53,]         0 0.00000000 0.068176443
#>  [54,]         0 0.00000000 0.065670399
#>  [55,]         0 0.00000000 0.063840563
#>  [56,]         0 0.00000000 0.063234392
#>  [57,]         0 0.00000000 0.063189342
#>  [58,]         0 0.00000000 0.059868540
#>  [59,]         0 0.00000000 0.059285719
#>  [60,]         0 0.00000000 0.058866113
#>  [61,]         0 0.00000000 0.056665629
#>  [62,]         0 0.00000000 0.056131890
#>  [63,]         0 0.00000000 0.055221726
#>  [64,]         0 0.00000000 0.054383073
#>  [65,]         0 0.00000000 0.053424110
#>  [66,]         0 0.00000000 0.052711260
#>  [67,]         0 0.00000000 0.051592529
#>  [68,]         0 0.00000000 0.050061244
#>  [69,]         0 0.00000000 0.049106015
#>  [70,]         0 0.00000000 0.048538771
#>  [71,]         0 0.00000000 0.048131669
#>  [72,]         0 0.00000000 0.047295623
#>  [73,]         0 0.00000000 0.047067993
#>  [74,]         0 0.00000000 0.046208831
#>  [75,]         0 0.00000000 0.045668485
#>  [76,]         0 0.00000000 0.045216427
#>  [77,]         0 0.00000000 0.044062798
#>  [78,]         0 0.00000000 0.043163334
#>  [79,]         0 0.00000000 0.042355499
#>  [80,]         0 0.00000000 0.040113039
#>  [81,]         0 0.00000000 0.039172078
#>  [82,]         0 0.00000000 0.035989881
#>  [83,]         0 0.00000000 0.035517071
#>  [84,]         0 0.00000000 0.035223243
#>  [85,]         0 0.00000000 0.034865081
#>  [86,]         0 0.00000000 0.034063248
#>  [87,]         0 0.00000000 0.033248437
#>  [88,]         0 0.00000000 0.029776983
#>  [89,]         0 0.00000000 0.029389071
#>  [90,]         0 0.00000000 0.027899370
#>  [91,]         0 0.00000000 0.027031372
#>  [92,]         0 0.00000000 0.026069254
#>  [93,]         0 0.00000000 0.025996476
#>  [94,]         0 0.00000000 0.024769890
#>  [95,]         0 0.00000000 0.024621462
#>  [96,]         0 0.00000000 0.020555701
#>  [97,]         0 0.00000000 0.014004707
#>  [98,]         0 0.00000000 0.009238432
#>  [99,]         0 0.00000000 0.008548402
#> [100,]         0 0.00000000 0.008162723
#> [101,]         1 0.38239273 1.632187167
#> [102,]         1 0.07209847 0.075896319
#> attr(,"class")
#> [1] "diagram"
#> attr(,"maxdimension")
#> [1] 1
#> attr(,"scale")
#> [1] 0.0000 1.6322
#> attr(,"call")
#> TDA::ripsDiag(X = noisy_circle_points, maxdimension = 1L, maxscale = 1.6322)
```

The data structure adopted by the *tdaverse* suite of packages and
provided by this package is designed to be a common interface for
persistence data. This allows for a seamless integration of persistence
data across different packages and ensures that the data is always in a
consistent format.

Specifically, the ‘persistence’ class is a list with the following
components:

- `pairs`: A list of 2-column matrices containing birth-death pairs. The
  -*th* element of the list corresponds to the -*th* homology dimension.
  If there is no pairs for a given dimension but there are pairs in
  higher dimensions, the corresponding element(s) is/are filled with a
  numeric matrix.

- `metadata`: A list of 3 elements containing information about how the
  data was computed:

  - `data`: The name of the object containing the original data on which
    the persistence data was computed.
  - `engine`: The name of the package that computed the persistence
    data.
  - `simplicial_complex`: The type of simplicial complex used in the
    computation.
  - `parameters`: A list of parameters used in the computation.
  - `call`: The exact call that generated the persistence data.

The `as_persistence()` function is used to convert persistence data from
different packages into the ‘persistence’ class. For example, the
persistence data computed using the **ripserr** package can be converted
into the ‘persistence’ class as follows:

``` r
as_persistence(noisy_circle_ripserr)
#> 
#> ── Persistence Data ────────────────────────────────────────────────────────────
#> ℹ There are 99 pairs in dimension 0.
#> ℹ There are  2 pairs in dimension 1.
#> 
#> ── Metadata ────────────────────────────────────────────────────────────────────
#> ℹ The data used to compute persistence is not available.
#> ℹ Persistence has been computed using the ripserr package.
#> ℹ The simplicial complex used in the computation is rips.
#> ℹ The function called to compute persistence is not available.
#> ℹ The parameters used for the computation are not available.
```

Similarly, the persistence data computed using the **TDA** package can
be converted into the ‘persistence’ class as follows:

``` r
as_persistence(noisy_circle_tda_rips)
#> 
#> ── Persistence Data ────────────────────────────────────────────────────────────
#> ℹ There are 100 pairs in dimension 0.
#> ℹ There are   2 pairs in dimension 1.
#> 
#> ── Metadata ────────────────────────────────────────────────────────────────────
#> ℹ The data used to compute persistence is stored in object noisy_circle_points.
#> ℹ Persistence has been computed using the TDA package.
#> ℹ The simplicial complex used in the computation is rips.
#> ℹ The function called was `ripsDiag()`.
#> ℹ The parameters used for the computation are:
#>     → maxdimension: 1
#>     → maxscale    : 1.6322
```
